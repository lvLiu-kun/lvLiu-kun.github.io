# 面经

## SQL 注入

mybatis在处理＃{}和${}有什么区别？
使用 #{} 可以预防 sql 注入，将 sql 中的#{}替换为 ? 占位符，参数是以预处理语句的参数传递给数据库的；
${} 会有 sql 注入风险，它不会转义特殊字符，直接替换为字符串。

## 有一条 sql，创建了索引，也各种优化了，但还是慢，怎么办？怎么去排查问题？比如说，我们观察到走了索引（index），第一种情况，直接扫了全表（MySQL 可能任务扫全表比不扫全表快些），第二种情况，他走了索引，也扫了全表。这种情况下怎么优化？

就是回表的情况？对查询的字段加索引。

再或者加缓存。

再或者冷热数据方案 。

再不行提高内存、硬盘、CPU 配置。

## 事务提交后，undolog 是否会删除之前版本的数据，只保留最新提交的版本数据？删除的时机是什么？

## where 使用 != 一定不会命中索引吗？

不一定，5.6 后可能会索引下推，并且如果查询字段能在非聚簇索引上能查到，就是索引下推+索引覆盖。

